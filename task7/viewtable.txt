
DROP TABLE IF EXISTS Employee;
DROP TABLE IF EXISTS Department;


CREATE TABLE Department (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);

CREATE TABLE Employee (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    salary INT,
    dept_id INT,
    FOREIGN KEY (dept_id) REFERENCES Department(dept_id)
);


INSERT INTO Department VALUES
(1, 'HR'),
(2, 'IT'),
(3, 'Finance');

INSERT INTO Employee VALUES
(101, 'Alice', 50000, 1),
(102, 'Bob', 60000, 2),
(103, 'Charlie', 40000, 1),
(104, 'David', 70000, 2),
(105, 'Eva', 55000, 3);

CREATE OR REPLACE VIEW HighSalaryEmployees AS
SELECT emp_id, emp_name, salary
FROM Employee
WHERE salary > 50000;

SELECT * FROM HighSalaryEmployees;

CREATE OR REPLACE VIEW EmployeeDepartment AS
SELECT e.emp_id, e.emp_name, e.salary, d.dept_name
FROM Employee e
JOIN Department d ON e.dept_id = d.dept_id;


SELECT * FROM EmployeeDepartment;


CREATE OR REPLACE VIEW DeptAvgSalary AS
SELECT d.dept_name, AVG(e.salary) AS avg_salary
FROM Employee e
JOIN Department d ON e.dept_id = d.dept_id
GROUP BY d.dept_name;

SELECT * FROM DeptAvgSalary;


CREATE OR REPLACE VIEW IT_Employees AS
SELECT emp_id, emp_name, salary
FROM Employee
WHERE dept_id = (SELECT dept_id FROM Department WHERE dept_name = 'IT');


SELECT * FROM IT_Employees;

DROP VIEW IF EXISTS IT_Employees;
