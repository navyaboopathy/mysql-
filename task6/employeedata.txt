
DROP TABLE IF EXISTS Employee;
DROP TABLE IF EXISTS Department;


CREATE TABLE Department (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);


CREATE TABLE Employee (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    salary INT,
    dept_id INT,
    FOREIGN KEY (dept_id) REFERENCES Department(dept_id)
);


INSERT INTO Department VALUES
(1, 'HR'),
(2, 'IT'),
(3, 'Finance');

INSERT INTO Employee VALUES
(101, 'Alice', 50000, 1),
(102, 'Bob', 60000, 2),
(103, 'Charlie', 40000, 1),
(104, 'David', 70000, 2),
(105, 'Eva', 55000, 3);


SELECT emp_name, salary
FROM Employee
WHERE salary > (SELECT AVG(salary) FROM Employee);


SELECT emp_name
FROM Employee
WHERE dept_id IN (
    SELECT dept_id FROM Department WHERE dept_name = 'IT'
);


SELECT dept_name
FROM Department d
WHERE EXISTS (
    SELECT 1 FROM Employee e
    WHERE e.dept_id = d.dept_id AND e.salary > 60000
);


SELECT emp_name, salary
FROM Employee e1
WHERE salary > (
    SELECT AVG(salary)
    FROM Employee e2
    WHERE e1.dept_id = e2.dept_id
);


SELECT d.dept_name, avg_data.avg_salary
FROM (
    SELECT dept_id, AVG(salary) AS avg_salary
    FROM Employee
    GROUP BY dept_id
) AS avg_data
JOIN Department d ON d.dept_id = avg_data.dept_id;
